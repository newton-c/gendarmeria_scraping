geom_bar() +
theme_ic()
year_plot
year_plot <- ggplot(yearly, aes(x = year, y = tires)) +
geom_col() +
theme_ic()
year_plot
source("scripts/finalize_plots.R")
source("/Users/cn/Desktop/IC/IC_data/ICplots/R/theme_ic.R")
source("~/Desktop/IC/2023/Argentina/Secuestros Extorsivos/scripts/finalize_plots.R")
year_plot <- ggplot(yearly, aes(x = year, y = tires)) +
geom_col(fill = "#B70039") +
labs(title = "Illegal Tire Seizures") +
ylab("# of Tires Seized") +
theme_ic()
year_plot
year_plot <- ggplot(yearly, aes(x = year, y = tires)) +
geom_col(fill = "#B70039") +
labs(title = "Illegal Tire Seizures") +
ylab("# of Tires Seized") +
geom_hline(yintercept = 0, color = "#3B3B3B")
year_plot <- ggplot(yearly, aes(x = year, y = tires)) +
geom_col(fill = "#B70039") +
labs(title = "Illegal Tire Seizures") +
ylab("# of Tires Seized") +
geom_hline(yintercept = 0, color = "#3B3B3B") +
theme_ic()
year_plot
finalise_plot(year_plot,
source_name = "Gendarmería Nacional Argentina",
save_filepath = "tires_seized.png")
View(prs)
View(tires)
View(yearly)
library(tidyverse)
library(ICplots)
prs <- read_csv("data/gendameria_2023-06-07.csv")
marijuana <- prs %>%
mutate(date = as.POSIXlt(date),
title = gsub("[.]", "", title),
incautaciones = str_extract(title, "([0-9]+ kilos de marihuana)"),
#incautaciones = str_extract(title, "([0-9]+ [a-z]+ de cocaína)"),
mari_kilos = as.numeric(str_extract(incautaciones, "[0-9]+")),
year = as.numeric(format(date, format = "%Y")),
month = as.numeric(format(date, format = "%m")),
year_month = as.numeric(format(date, format = "%Y.%m")),
filter_col = grepl("marihuana", text)) %>%
filter(filter_col == TRUE) %>%
select(-filter_col)
marijuana <- prs %>%
mutate(date = as.POSIXlt(date),
title = gsub("[.]", "", title),
incautaciones = str_extract(title, "([0-9]+ kilos de marihuana)"),
#incautaciones = str_extract(title, "([0-9]+ [a-z]+ de cocaína)"),
mari_kilos = as.numeric(str_extract(incautaciones, "[0-9]+")),
year = as.numeric(format(date, format = "%Y")),
month = as.numeric(format(date, format = "%m")),
year_month = as.numeric(format(date, format = "%Y.%m")),
filter_col = grepl("marihuana", text)) %>%
filter(filter_col == TRUE) %>%
select(-filter_col)
write_excel_csv(marijuana, "data/gendameria_marijuana_2023-06-07.csv")
View(marijuana)
library(tidyverse)
library(ICplots)
prs <- read_csv("data/gendameria_2023-06-07.csv")
View(prs)
cocaine <- prs %>%
mutate(date = as.POSIXlt(date),
title = gsub("[.]", "", title),
incautaciones = str_extract(title, "([0-9]+ kilos de cocaína)"),
#incautaciones = str_extract(title, "([0-9]+ [a-z]+ de cocaína)"),
coke_kilos = as.numeric(str_extract(incautaciones, "[0-9]+")),
year = as.numeric(format(date, format = "%Y")),
month = as.numeric(format(date, format = "%m")),
year_month = as.numeric(format(date, format = "%Y.%m")),
filter_col = grepl("cocaína", text)) %>%
filter(filter_col == TRUE) %>%
select(-filter_col)
View(cocaine)
library(tidyverse)
library(ICplots)
prs <- read_csv("data/gendameria_2023-06-07.csv")
library(rvest)
prov <- read_html("https://es.wikipedia.org/wiki/Provincias_de_Argentina") %>%
html_elements("td")
View(prov)
prov <- read_html("https://es.wikipedia.org/wiki/Provincias_de_Argentina") %>%
html_elements("td") %>%
html_elements("b") %>%
html_attrs("title")
prov <- read_html("https://es.wikipedia.org/wiki/Provincias_de_Argentina") %>%
html_elements("td") %>%
html_elements("b") %>%
html_attrs(".title")
read_html("https://es.wikipedia.org/wiki/Provincias_de_Argentina") %>%
html_elements("td") %>%
html_elements("b")
prov <- read_html("https://es.wikipedia.org/wiki/Provincias_de_Argentina") %>%
html_elements("td") %>%
html_elements("b") %>%
html_elements("a") %>%
html_attr("title")
prov
?str_extract_all
prov[[1]]
prs$prov <- NA
for (i in seq_along(prov)) {
for (j in seq_length(nrow(prs))) {
if (is.na(prs$prov))
if (prov[[i]] %in% prs$text) {
prs$prov[[j]] <- prov[[i]]
}
} else {
for (i in seq_along(prov)) {
for (j in seq_length(nrow(prs))) {
if (is.na(prs$prov)) {
if (prov[[i]] %in% prs$text) {
prs$prov[[j]] <- prov[[i]]
}
} else {
prs$prov[[j]] <- "Multiple Provinces listed"
}
}
}
for (j in seq_len(nrow(prs))) {
if (is.na(prs$prov)) {
if (prov[[i]] %in% prs$text) {
prs$prov[[j]] <- prov[[i]]
}
} else {
prs$prov[[j]] <- "Multiple Provinces listed"
}
}
for (i in seq_along(prov)) {
for (j in seq_len(nrow(prs))) {
if (is.na(prs$prov)) {
if (prov[[i]] %in% prs$text) {
prs$prov[[j]] <- prov[[i]]
}
} else {
prs$prov[[j]] <- "Multiple Provinces listed"
}
}
}
if (is.na(prs$prov[[j]])) {
if (prov[[i]] %in% prs$text) {
prs$prov[[j]] <- prov[[i]]
}
} else {
prs$prov[[j]] <- "Multiple Provinces listed"
}
prs <- read_csv("data/gendameria_2023-06-07.csv")
prs$prov <- NA
for (i in seq_along(prov)) {
for (j in seq_len(nrow(prs))) {
if (is.na(prs$prov[[j]])) {
if (prov[[i]] %in% prs$text) {
prs$prov[[j]] <- prov[[i]]
}
} else {
prs$prov[[j]] <- "Multiple Provinces listed"
}
}
}
View(prs)
class(prov)
prov <- read_html("https://es.wikipedia.org/wiki/Provincias_de_Argentina") %>%
html_elements("td") %>%
html_elements("b") %>%
html_elements("a") %>%
html_attr("title") %>%
as.list
View(prov)
for (i in seq_along(prov)) {
for (j in seq_len(nrow(prs))) {
if (is.na(prs$prov[[j]])) {
if (prov[[i]] %in% prs$text) {
prs$prov[[j]] <- prov[[i]]
}
} else {
prs$prov[[j]] <- "Multiple Provinces listed"
}
}
}
for (i in seq_along(prov)) {
for (j in seq_len(nrow(prs))) {
if (is.na(prs$prov[[j]])) {
print("It's NA")
if (prov[[i]] %in% prs$text) {
prs$prov[[j]] <- prov[[i]]
}
} else {
prs$prov[[j]] <- "Multiple Provinces listed"
}
}
}
for (i in seq_along(prov)) {
for (j in seq_len(nrow(prs))) {
if (is.na(prs$prov[[j]])) {
if (prov[[i]] %in% prs$text) {
print("It seems to work")
prs$prov[[j]] <- prov[[i]]
}
} else {
prs$prov[[j]] <- "Multiple Provinces listed"
}
}
}
if (prov[[i]] %in% prs$text[[j]]) {
print("It seems to work")
prs$prov[[j]] <- prov[[i]]
}
for (i in seq_along(prov)) {
for (j in seq_len(nrow(prs))) {
if (is.na(prs$prov[[j]])) {
if (prov[[i]] %in% prs$text[[j]]) {
print("It seems to work")
prs$prov[[j]] <- prov[[i]]
}
} else {
prs$prov[[j]] <- "Multiple Provinces listed"
}
}
}
prs$text[[1]]
"los" %in% prs$text[[1]]
"los" %in% prs$text[[1]][[1]]
los %in% prs$text[[1]][[1]]
"los" %in% as.character(prs$text[[1]][[1]])
str_extract("los", prs$text[[1]])
str_extract("los", prs$text[1])
str_extract("los", prs$text)
str_extract("a", prs$text)
str_extract(prs$text[[1]], "los")
prs$text[[2]]
prov <- read_html("https://es.wikipedia.org/wiki/Provincias_de_Argentina") %>%
html_elements("td") %>%
html_elements("b") %>%
html_elements("a") %>%
html_attr("title") %>%
gsub("Provincia de ", "" )
prov <- read_html("https://es.wikipedia.org/wiki/Provincias_de_Argentina") %>%
html_elements("td") %>%
html_elements("b") %>%
html_elements("a") %>%
html_attr("title") %>%
gsub("Provincia de ", "" ) %>%
as.list
prov <- read_html("https://es.wikipedia.org/wiki/Provincias_de_Argentina") %>%
html_elements("td") %>%
html_elements("b") %>%
html_elements("a") %>%
html_attr("title") %>%
as.list() %>%
gsub("Provincia de ", "" )
gsub
?gsub
prov <- read_html("https://es.wikipedia.org/wiki/Provincias_de_Argentina") %>%
html_elements("td") %>%
html_elements("b") %>%
html_elements("a") %>%
html_attr("title") %>%
as.list() %>%
sub("Provincia de ", "", .)
prs$text[[2]]
prov <- read_html("https://es.wikipedia.org/wiki/Provincias_de_Argentina") %>%
html_elements("td") %>%
html_elements("b") %>%
html_elements("a") %>%
html_attr("title") %>%
sub("Provincia de ", "", .) %>%
as.list
str_extract(prs$text[[2]], prov[[9]])
for (i in seq_along(prov)) {
for (j in seq_len(nrow(prs))) {
if (is.na(prs$prov[[j]])) {
prs$prov[[j]] <- str_extract(prs$text[[j]], prov[[i]])
} else {
prs$prov[[j]] <- "Multiple Provinces listed"
}
}
}
View(prs)
for (i in seq_along(prov)) {
for (j in seq_len(nrow(prs))) {
if (is.na(prs$prov[[j]])) {
prs$prov[[j]] <- str_extract(prs$text[[j]], prov[[i]])
}
}
}
View(prs)
for (i in seq_along(prov)) {
for (j in seq_len(nrow(prs))) {
prs$prov[[j]] <- str_extract(prs$text[[j]], prov[[i]])
}
}
View(prs)
for (i in seq_along(prov)) {
for (j in seq_len(nrow(prs))) {
if (!is.na(prs$prov[[j]]))
prs$prov[[j]] <- str_extract(prs$text[[j]], prov[[i]])
} else {
for (i in seq_along(prov)) {
for (j in seq_len(nrow(prs))) {
if (!is.na(prs$prov[[j]])) {
prs$prov[[j]] <- str_extract(prs$text[[j]], prov[[i]])
} else {
prs$prov[[j]] <- paste(prs$prov[[j]],
str_extract(prs$text[[j]], prov[[i]]),
sep = ", ")
}
}
}
View(prs)
for (i in seq_along(prov)) {
for (j in seq_len(nrow(prs))) {
if (is.na(prs$prov[[j]])) {
prs$prov[[j]] <- str_extract(prs$text[[j]], prov[[i]])
} else {
prs$prov[[j]] <- paste(prs$prov[[j]],
str_extract(prs$text[[j]], prov[[i]]),
sep = ", ")
}
}
}
for (i in seq_along(prov)) {
for (j in seq_len(nrow(prs))) {
if (is.na(prs$prov[[j]])) {
prs$prov[[j]] <- str_extract(prs$text[[j]], prov[[i]])
} if (!is.na(prs$prov[[j]])) {
for (i in seq_along(prov)) {
for (j in seq_len(nrow(prs))) {
if (is.na(prs$prov[[j]])) {
prs$prov[[j]] <- str_extract(prs$text[[j]], prov[[i]])
} if (!is.na(prs$prov[[j]])) {
for (i in seq_along(prov)) {
for (j in seq_len(nrow(prs))) {
if (is.na(prs$prov[[j]])) {
prs$prov[[j]] <- str_extract(prs$text[[j]], prov[[i]])
} else if (!is.na(prs$prov[[j]])) {
prs$prov[[j]] <- paste(prs$prov[[j]],
str_extract(prs$text[[j]], prov[[i]]),
sep = ", ")
}
}
}
View(prs)
prs$prov <- sub("NA,", "", prs$prov)
prs$prov <- gsub("NA,", ",", prs$prov)
prs$prov <- gsub("NA,", "", prs$prov)
prs$prov <- gsub("NA, ", " ", prs$prov)
prs$prov <- gsub("NA,", ",", prs$prov)
for (i in seq_along(prov)) {
for (j in seq_len(nrow(prs))) {
if (is.na(prs$prov[[j]])) {
prs$prov[[j]] <- str_extract(prs$text[[j]], prov[[i]])
} else if (!is.na(prs$prov[[j]])) {
match <- str_extract(prs$text[[j]], prov[[i]]) %>%
unique
prs$prov[[j]] <- paste(prs$prov[[j]],
match,
sep = ", ")
}
}
}
View(prs)
prs <- read_csv("data/gendameria_2023-06-07.csv")
prs$prov <- NA
for (i in seq_along(prov)) {
for (j in seq_len(nrow(prs))) {
if (is.na(prs$prov[[j]])) {
prs$prov[[j]] <- str_extract(prs$text[[j]], prov[[i]])
} else if (!is.na(prs$prov[[j]])) {
match <- str_extract(prs$text[[j]], prov[[i]]) %>%
unique
prs$prov[[j]] <- paste(prs$prov[[j]],
match,
sep = ", ")
}
}
}
View(prs)
prs$prov <- gsub("NA,", "", prs$prov)
View(prs)
prs$prov <- gsub("NA", "", prs$prov)
prs$prov <- gsub("NA", "", prs$prov) %>%
gsub("\s+", prs$prov, perl = TRUE)
prs$prov <- gsub("NA", "", prs$prov) %>%
gsub(" +", prs$prov, perl = TRUE)
prs$prov <- gsub("NA", "", prs$prov)
prs$prov <- gsub(" +", prs$prov, perl = TRUE)
prs$prov <- gsub(" +", "", prs$prov, perl = TRUE)
View(prs)
prs$prov <- gsub(" ", "", prs$prov, perl = TRUE)
prs <- read_csv("data/gendameria_2023-06-07.csv")
prs$prov <- NA
for (i in seq_along(prov)) {
for (j in seq_len(nrow(prs))) {
if (is.na(prs$prov[[j]])) {
prs$prov[[j]] <- str_extract(prs$text[[j]], prov[[i]])
} else if (!is.na(prs$prov[[j]])) {
match <- str_extract(prs$text[[j]], prov[[i]]) %>%
unique
prs$prov[[j]] <- paste(prs$prov[[j]],
match,
sep = ", ")
}
}
}
prs$prov <- gsub("NA", "", prs$prov) %>%
gsub(" ", "", prs$prov, perl = TRUE)
prs$prov <- gsub("NA", "", prs$prov)
prs$prov <- gsub(" ", "", prs$prov, perl = TRUE)
prs <- read_csv("data/gendameria_2023-06-07.csv")
prs$prov <- NA
for (i in seq_along(prov)) {
for (j in seq_len(nrow(prs))) {
if (is.na(prs$prov[[j]])) {
prs$prov[[j]] <- str_extract(prs$text[[j]], prov[[i]])
} else if (!is.na(prs$prov[[j]])) {
match <- str_extract(prs$text[[j]], prov[[i]]) %>%
unique
prs$prov[[j]] <- paste(prs$prov[[j]],
match,
sep = ", ")
}
}
}
prs$prov <- gsub("NA", "", prs$prov)
prs$prov <- gsub(" ", "", prs$prov, perl = TRUE)
prs$prov <- gsub("\\s+", " ", prs$prov, perl = TRUE)
prs <- read_csv("data/gendameria_2023-06-07.csv")
prs$prov <- NA
for (i in seq_along(prov)) {
for (j in seq_len(nrow(prs))) {
if (is.na(prs$prov[[j]])) {
prs$prov[[j]] <- str_extract(prs$text[[j]], prov[[i]])
} else if (!is.na(prs$prov[[j]])) {
match <- str_extract(prs$text[[j]], prov[[i]]) %>%
unique
prs$prov[[j]] <- paste(prs$prov[[j]],
match,
sep = ", ")
}
}
}
prs$prov <- gsub("NA", "", prs$prov)
prs$prov <- gsub("\\s+", " ", prs$prov, perl = TRUE)
prov <- read_html("https://es.wikipedia.org/wiki/Provincias_de_Argentina") %>%
html_elements("td") %>%
html_elements("b") %>%
html_elements("a") %>%
html_attr("title") %>%
sub("Provincia de ", "", .) %>%
as.list
prs <- read_csv("data/gendameria_2023-06-07.csv")
prs$prov <- NA
for (i in seq_along(prov)) {
for (j in seq_len(nrow(prs))) {
if (is.na(prs$prov[[j]])) {
prs$prov[[j]] <- str_extract(prs$text[[j]], prov[[i]])
} else if (!is.na(prs$prov[[j]])) {
match <- str_extract(prs$text[[j]], prov[[i]]) %>%
unique
prs$prov[[j]] <- paste(prs$prov[[j]],
match,
sep = ", ")
}
}
}
prs$prov <- gsub("NA", "", prs$prov)
prs$prov <- gsub("\\s+", "", prs$prov, perl = TRUE)
prs$prov <- gsub(", ,", "", prs$prov)
prs <- read_csv("data/gendameria_2023-06-07.csv")
prs$prov <- NA
for (i in seq_along(prov)) {
for (j in seq_len(nrow(prs))) {
if (is.na(prs$prov[[j]])) {
prs$prov[[j]] <- str_extract(prs$text[[j]], prov[[i]])
} else if (!is.na(prs$prov[[j]])) {
match <- str_extract(prs$text[[j]], prov[[i]]) %>%
unique
prs$prov[[j]] <- paste(prs$prov[[j]],
match,
sep = ", ")
}
}
}
prs$prov <- gsub("NA", "", prs$prov)
prs$prov <- gsub("\\s+", " ", prs$prov, perl = TRUE)
prs$prov <- gsub(", ,", "", prs$prov)
prs$prov <- gsub("\\s+,", ",", prs$prov, perl = TRUE)
prs$prov <- gsub(",$", "", prs$prov, perl = TRUE)
View(prs)
prs <- read_csv("data/gendameria_2023-06-07.csv")
prs$prov <- NA
for (i in seq_along(prov)) {
for (j in seq_len(nrow(prs))) {
if (is.na(prs$prov[[j]])) {
prs$prov[[j]] <- str_extract(prs$text[[j]], prov[[i]])
} else if (!is.na(prs$prov[[j]])) {
match <- str_extract(prs$text[[j]], prov[[i]]) %>%
unique
prs$prov[[j]] <- paste(prs$prov[[j]],
match,
sep = " ")
}
}
}
prs$prov <- gsub("NA", "", prs$prov)
prs$prov <- gsub("\\s+", " ", prs$prov, perl = TRUE)
